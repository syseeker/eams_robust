# [m0]  
# Attendees=5469,27311,7416,10402,49192
# Duration=4
# CreateTime=2012-01-08 09:00
#     [[W1]]
#     Start=2012-01-09 09:00
#     End=2012-01-09 13:30

# (402, 410)

# r4_mtest,1843.24,921.62,0.44,0.67,49.972,0.7,0.6667,0.99
# r4_mtest,1826.91,913.46,0.69,1.51,47.11,1.5,1.5,0.99
# r4_mtest,1808.25,904.12,0.95,2.69,45.726,2.3,2.6668,0.99
# {"(0, 1, 409)": [0.0, 23.22961300216765, 0.22961300216764968], "(0, 1, 407)": [0.0, 23.0, 0.0], "(0, 1, 410)": [0.0, 23.44113671283574, 0.4411367128357391], "(0, 1, 408)": [0.0, 23.002617284996607, 0.002617284996606628]}
# {"(0, 1, 409)": [0.0, 23.491187087895096, 0.4911870878950957], "(0, 1, 407)": [0.0, 23.055814382945943, 0.05581438294594321], "(0, 1, 410)": [0.0, 23.68683045813607, 0.6868304581360682], "(0, 1, 408)": [0.0, 23.28116807102289, 0.2811680710228899]}
# {"(0, 1, 409)": [0.0, 23.77605679813362, 0.7760567981336202], "(0, 1, 407)": [0.0, 23.378495079390106, 0.37849507939010607], "(0, 1, 410)": [0.0, 23.95460298483846, 0.9546029848384592], "(0, 1, 408)": [0.0, 23.58431313763781, 0.5843131376378103]}

# 
# r4_mtest,1842.01,921.0,0.46,0.73,46.518,0.7,0.6667,0.9
# r4_mtest,1824.75,912.38,0.72,1.65,44.611,1.5,1.5,0.9
# r4_mtest,1804.46,902.23,1.01,2.93,46.768,2.3,2.6668,0.9
# {"(0, 1, 409)": [0.0, 23.249585982964096, 0.24958598296409562], "(0, 1, 407)": [0.0, 23.0, 0.0], "(0, 1, 410)": [0.0, 23.45989284109439, 0.45989284109439055], "(0, 1, 408)": [0.0, 23.023891175941525, 0.023891175941525233]}
# {"(0, 1, 409)": [0.0, 23.523824693736653, 0.5238246937366533], "(0, 1, 407)": [0.0, 23.09276718187747, 0.0927671818774698], "(0, 1, 410)": [0.0, 23.717516724480326, 0.7175167244803262], "(0, 1, 408)": [0.0, 23.315891399905556, 0.31589139990555637]}
# {"(0, 1, 409)": [0.0, 23.834071176097844, 0.8340711760978436], "(0, 1, 407)": [0.0, 23.444223516887668, 0.4442235168876678], "(0, 1, 410)": [0.0, 24.009129353461617, 1.009129353461617], "(0, 1, 408)": [0.0, 23.646055953552874, 0.6460559535528745]}

# 
# r4_mtest,1839.27,919.64,0.5,0.87,48.222,0.7,0.6667,0.7
# r4_mtest,1819.97,909.98,0.79,1.95,47.004,1.5,1.5,0.7
# r4_mtest,1796.06,898.03,1.13,3.47,45.787,2.3,2.6668,0.7
# {"(0, 1, 409)": [0.0, 23.293970384733957, 0.29397038473395654], "(0, 1, 407)": [0.0, 23.0, 0.0], "(0, 1, 410)": [0.0, 23.501573126113605, 0.5015731261136054], "(0, 1, 408)": [0.0, 23.07116648915244, 0.07116648915243928]}
# {"(0, 1, 409)": [0.0, 23.596349810331724, 0.5963498103317235], "(0, 1, 407)": [0.0, 23.174892801298036, 0.17489280129803575], "(0, 1, 410)": [0.0, 23.785700554011996, 0.7857005540119957], "(0, 1, 408)": [0.0, 23.393056834358248, 0.3930568343582479]}
# {"(0, 1, 409)": [0.0, 23.96299201601834, 0.9629920160183403], "(0, 1, 407)": [0.0, 23.590286711326694, 0.5902867113266943], "(0, 1, 410)": [0.0, 24.13029906151308, 1.1302990615130817], "(0, 1, 408)": [0.0, 23.783262211141892, 0.7832622111418921]}

# 
# r4_mtest,1836.54,918.27,0.54,1.0,48.661,0.7,0.6667,0.5
# r4_mtest,1815.24,907.62,0.85,2.25,45.502,1.5,1.5,0.5
# r4_mtest,1787.65,893.82,1.25,4.0,45.347,2.3,2.6668,0.5
# {"(0, 1, 409)": [0.0, 23.338354786503835, 0.3383547865038352], "(0, 1, 407)": [0.0, 23.0, 0.0], "(0, 1, 410)": [0.0, 23.543253411132817, 0.5432534111328167], "(0, 1, 408)": [0.0, 23.11844180236335, 0.11844180236334978]}
# {"(0, 1, 409)": [0.0, 23.66886415706967, 0.6688641570696703], "(0, 1, 407)": [0.0, 23.25704924034803, 0.25704924034803156], "(0, 1, 410)": [0.0, 23.853855107063282, 0.853855107063282], "(0, 1, 408)": [0.0, 23.470231495519013, 0.47023149551901255]}
# {"(0, 1, 409)": [0.0, 24.091912734435706, 1.0919127344357058], "(0, 1, 407)": [0.0, 23.73635025346126, 0.7363502534612607], "(0, 1, 410)": [0.0, 24.251468439283368, 1.251468439283368], "(0, 1, 408)": [0.0, 23.92046857281966, 0.9204685728196615]}


import matplotlib.pyplot as plt
import matplotlib.gridspec as gridspec
import matplotlib.patches as patches
import numpy as np
from matplotlib.font_manager import FontProperties
    
fig = plt.figure()
gs = gridspec.GridSpec(3, 1)
gs.update(hspace=0.5)
sfig = fig.add_subplot(gs[0,:])
tfig = fig.add_subplot(gs[1:,:])


colors = ['r','g','b','w','k','grey']
lines = ['-.', '-', '.']

pslot = ['t1', 't2', 't3', 't4', 't5', 't6', 't7', 't8', 't9']
oat = [27.7, 28.5, 29.35, 30.2, 31.0, 31.8, 31.7, 31.6, 31.45]
std_high = [23]*len(oat)
std_low = [21]*len(oat)
rt_low_flex     = [26,26,26,26, 23.0, 23.0, 23.01, 23.24, 26]
rt_medium_flex  = [26,26,26,26, 23.0, 23.15, 23.37, 23.57, 26]
rt_high_flex    = [26,26,26,26, 23.33, 23.54, 23.73, 23.91, 26]

# {"(0, 1, 409)": [0.0, 23.016039864358575, 0.016039864358575073], "(0, 1, 407)": [0.0, 23.0, 0.0], "(0, 1, 410)": [0.0, 23.240623135641425, 0.24062313564142457], "(0, 1, 408)": [0.0, 23.0, 0.0]}
# {"(0, 1, 409)": [0.0, 23.371624780180888, 0.3716247801808876], "(0, 1, 407)": [0.0, 23.0, 0.0], "(0, 1, 410)": [0.0, 23.574496432639247, 0.574496432639247], "(0, 1, 408)": [0.0, 23.15387878717986, 0.1538787871798597]}
# {"(0, 1, 409)": [0.0, 23.73654421402509, 0.7365442140250913], "(0, 1, 407)": [0.0, 23.333728583461358, 0.33372858346135814], "(0, 1, 410)": [0.0, 23.917466023244508, 0.9174660232445078], "(0, 1, 408)": [0.0, 23.54226117926905, 0.542261179269051]}


sfig.set_xlim(0, 120)  
sfig.set_ylim(0, 3)  

for p in [
    patches.Rectangle(
        (0, 0), 30, 2.3,
        facecolor="blue"      # Default
    ),
    patches.Rectangle(
        (0, 0), 20, 1.5,
        facecolor="green"     # No background
    ),
    patches.Rectangle(
        (0, 0), 10, 0.7,
        facecolor="red"
    ),
]:
    sfig.add_patch(p)
sfig.set_ylabel("Temperature ($\circ$C)", fontsize=12)
sfig.set_xlabel("Duration (minutes)", fontsize=12)

# tfig.plot(range(len(pslot)), oat, lines[1], color=colors[4], label='Outdoor Temperature')
tfig.plot(range(len(pslot)), std_high, lines[1], color=colors[5], label='Default Cooling Setpoint')
tfig.plot(range(len(pslot)), std_low, lines[1], color=colors[5], label='Default Heating Setpoint')
tfig.plot(range(len(pslot)), rt_low_flex, 'd', color=colors[0], label='Occupied Temperature - Low Flexibility')
tfig.plot(range(len(pslot)), rt_medium_flex, 'o', color=colors[1], label='Occupied Temperature - Medium Flexibility')
tfig.plot(range(len(pslot)), rt_high_flex, '^', color=colors[2], label='Occupied Temperature - High Flexibility')
tfig.set_ylim(20, 36)  
tfig.set_ylabel("Temperature ($\circ$C)", fontsize=12)
tfig.set_xlabel("Time Windows (in slots)", fontsize=12)
tfig.set_xticklabels(pslot)
plt.setp(tfig.get_xticklabels(), rotation='30', ha='right', fontsize=12)
handles, labels = tfig.get_legend_handles_labels()
fontP = FontProperties()
fontP.set_size(8)
tfig.legend(handles, labels, ncol=2, loc='best',prop=fontP)
# tfig.legend(loc='center right', bbox_to_anchor=(1.1, 0.55),
#           fancybox=True, shadow=False, ncol=2, prop=fontP)

# plt.show()
plt.savefig('Example/fixed_slack.png', dpi=400)
plt.close()
    
    

    
    
    
    